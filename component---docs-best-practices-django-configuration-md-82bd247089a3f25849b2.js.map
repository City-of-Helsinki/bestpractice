{"version":3,"sources":["webpack:///../docs/best-practices/django-configuration.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"yeAMO,IAAMA,EAAe,Q,6NAE5B,IAKMC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,E,oIACF,mBACD,OAAO,YAACJ,EAAD,KAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,cAG5E,iBAAQ,CACN,GAAM,sDADR,sDAGA,0HACA,4CAA2B,mBAAGC,WAAW,KAAQ,CAC7C,KAAQ,6CADe,kBAA3B,0GAIA,iBAAQ,CACN,GAAM,iBADR,iBAGA,kEAAiD,0BAAYA,WAAW,KAAvB,eAAjD,6HAEA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,uhBAgBL,gEAA+C,0BAAYA,WAAW,KAAvB,OAA/C,8CACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,qWAQL,iBAAQ,CACN,GAAM,kCADR,kCAGA,+OAGA,gEAA+C,0BAAYA,WAAW,KAAvB,mBAA/C,8KAIA,iBAAQ,CACN,GAAM,wCADR,wCAGA,qBAAG,0BAAYA,WAAW,KAAvB,gCAAH,iTAIkC,0BAAYA,WAAW,KAAvB,sCAClC,qBAAG,0BAAYA,WAAW,KAAvB,6BAAH,iNAGF,0BAAYA,WAAW,KAAvB,oCAHE,mCAIF,0BAAYA,WAAW,KAAvB,wCACE,wF,oNAKJJ,EAAWK,gBAAiB","file":"component---docs-best-practices-django-configuration-md-82bd247089a3f25849b2.js","sourcesContent":["import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/bestpractice/bestpractice/node_modules/gatsby-theme-docz/src/base/Layout.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"configuration-for-city-of-helsinki-django-projects\"\n    }}>{`Configuration for City of Helsinki Django projects`}</h1>\n    <p>{`Configuration for all new projects should be done using environment variables if at all possible.`}</p>\n    <p>{`Projects should use `}<a parentName=\"p\" {...{\n        \"href\": \"https://pypi.org/project/django-environ/\"\n      }}>{`django-environ`}</a>{` for reading environment\nvariables. This makes it easy to inspect available settings from settings.py`}</p>\n    <h2 {...{\n      \"id\": \"usage-example\"\n    }}>{`Usage example`}</h2>\n    <p>{`Specify the available variables using the `}<inlineCode parentName=\"p\">{`environ.Env`}</inlineCode>{` constructor. Include types and default values here.\nThis makes for a nice single-point-of-truth for available settings.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`env = environ.Env(\n    DEBUG=(bool, True),\n    SECRET_KEY=(str, ''),\n    ALLOWED_HOSTS=(list, []),\n    ADMINS=(list, []),\n    DATABASE_URL=(str, 'postgis://mvj:mvj@localhost/mvj'),\n    CACHE_URL=(str, 'locmemcache://'),\n    EMAIL_URL=(str, 'consolemail://'),\n    SENTRY_DSN=(str, ''),\n    TOKEN_AUTH_ACCEPTED_AUDIENCE=(str, ''),\n    TOKEN_AUTH_ACCEPTED_SCOPE_PREFIX=(str, ''),\n    TOKEN_AUTH_AUTHSERVER_URL=(str, ''),\n    TOKEN_AUTH_FIELD_FOR_CONSENTS=(str, ''),\n    TOKEN_AUTH_REQUIRE_SCOPE_PREFIX=(bool, True),\n)\n`}</code></pre>\n    <p>{`Access parsed values using your defined `}<inlineCode parentName=\"p\">{`env`}</inlineCode>{`. Authentication config is a typical case:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`OIDC_API_TOKEN_AUTH = {\n    'AUDIENCE': env('TOKEN_AUTH_ACCEPTED_AUDIENCE'),\n    'API_SCOPE_PREFIX': env('TOKEN_AUTH_ACCEPTED_SCOPE_PREFIX'),\n    'ISSUER': env('TOKEN_AUTH_AUTHSERVER_URL'),\n    'API_AUTHORIZATION_FIELD': env('TOKEN_AUTH_FIELD_FOR_CONSENTS'),\n    'REQUIRE_API_SCOPE_FOR_AUTHENTICATION': env('TOKEN_AUTH_REQUIRE_SCOPE_PREFIX'),\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"authentication-config-for-apis\"\n    }}>{`Authentication config for APIs`}</h2>\n    <p>{`Software implementing an APIs need to often need the ability to authenticate\nincoming requests, fe. when personal data is requested. City of Helsinki\nprojects use a token authentication based on OIDC/Oauth stuff.`}</p>\n    <p>{`The software component handling this is `}<inlineCode parentName=\"p\">{`django-helusers`}</inlineCode>{`. Which needs\nOIDC_API_TOKEN_AUTH dict filled as seen above. For easier operations the\nconfiguration variables should be mapped to environment variables as seen\nabove.`}</p>\n    <h3 {...{\n      \"id\": \"meaning-of-the-environment-variables\"\n    }}>{`Meaning of the environment variables`}</h3>\n    <p><inlineCode parentName=\"p\">{`TOKEN_AUTH_ACCEPTED_AUDIENCE`}</inlineCode>{`: specifies the \"aud\"-field that should be\npresent in the token presented by the client. This is an URL identifying\na single deployment of your API software. However, it is not the url where\nthe API is located, but instead an identifier in the namespace used by\nauthentication server. For example: `}<inlineCode parentName=\"p\">{`https://api.hel.fi/auth/haravadev`}</inlineCode></p>\n    <p><inlineCode parentName=\"p\">{`TOKEN_AUTH_AUTHSERVER_URL`}</inlineCode>{`: specifies the URL the the authentication server\nstandard OIDC-endpoint. As opposed to the \"accepted audience\" setting, this\nis a honest to goodness URL. The libraries handling OIDC will expect to find\n`}<inlineCode parentName=\"p\">{`.well-known/openid-configuration`}</inlineCode>{` path under this url. Example:\n`}<inlineCode parentName=\"p\">{`https://api.hel.fi/sso-test/openid/`}</inlineCode></p>\n    <p>{`There are also other variables. I've forgotten what they mean.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}